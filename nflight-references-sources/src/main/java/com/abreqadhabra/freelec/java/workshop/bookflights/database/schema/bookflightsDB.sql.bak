CREATE TABLE APP.CITIES
(
 CITY_ID          INTEGER NOT NULL constraint cities_pk primary key,
 CITY_NAME        VARCHAR(24) NOT NULL,
 COUNTRY          VARCHAR(26) NOT NULL,
 AIRPORT          VARCHAR(26),
 LANGUAGE         VARCHAR(16),
 COUNTRY_ISO_CODE CHAR(2) 
);

CREATE TABLE APP.FLIGHTS
(
 FLIGHT_ID      CHAR(6) NOT NULL,
 SEGMENT_NUMBER INTEGER NOT NULL,
 ORIG_AIRPORT   CHAR(3),
 DEPART_TIME    TIME,
 DEST_AIRPORT   CHAR(3),
 ARRIVE_TIME    TIME,
 MEAL           CHAR(1) CONSTRAINT MEAL_CONSTRAINT 
 CHECK (meal IN ('B', 'L', 'D', 'S')),
 FLYING_TIME    DOUBLE PRECISION,
 MILES          INTEGER,
 AIRCRAFT       VARCHAR(6),
 CONSTRAINT FLIGHTS_PK Primary Key (FLIGHT_ID, SEGMENT_NUMBER)
);

CREATE TABLE APP.FLIGHTAVAILABILITY
(
 FLIGHT_ID              CHAR(6) NOT NULL ,
 SEGMENT_NUMBER         INTEGER NOT NULL ,
 FLIGHT_DATE            DATE NOT NULL ,
 ECONOMY_SEATS_TAKEN    INTEGER DEFAULT 0,
 BUSINESS_SEATS_TAKEN   INTEGER DEFAULT 0,
 FIRSTCLASS_SEATS_TAKEN INTEGER DEFAULT 0,
 CONSTRAINT FLIGHTAVAIL_PK Primary Key 
 (FLIGHT_ID, SEGMENT_NUMBER, FLIGHT_DATE),
 CONSTRAINT FLIGHTS_FK2 Foreign Key (FLIGHT_ID, SEGMENT_NUMBER)
 REFERENCES FLIGHTS (FLIGHT_ID, SEGMENT_NUMBER)
);

CREATE TABLE APP.FLIGHTHISTORY
(
 ID             INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY,
 USERNAME       VARCHAR(26) NOT NULL,
 FLIGHT_ID      CHAR(6) NOT NULL,
 ORIG_AIRPORT   CHAR(3) NOT NULL,
 DEST_AIRPORT   CHAR(3) NOT NULL,
 BEGIN_DATE     CHAR(12),
 CLASS          CHAR(12)
);

CREATE TABLE APP.USERS 
(
 ID             INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY,
 USERNAME       VARCHAR(40) NOT NULL,
 PASSWORD       VARCHAR(20)
);